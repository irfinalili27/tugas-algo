{% extends "base.html" %}
{% block content %}
<div class="container mt-4 text-center">
  <h2 class="mb-4">Visualisasi Integral & Luas Area</h2>
  <form id="integralForm" class="mb-4">
    <input type="text" id="function" class="form-control mb-2" placeholder="Masukkan fungsi, misal: x**2" required>
    <input type="number" id="a" class="form-control mb-2" placeholder="Batas bawah (a)" required>
    <input type="number" id="b" class="form-control mb-2" placeholder="Batas atas (b)" required>
    <button type="submit" class="btn btn-primary mt-2">Hitung & Tampilkan Grafik</button>
  </form>

  <canvas id="integralChart" height="100"></canvas>
  <h4 class="mt-3" id="areaResult"></h4>
</div>

<script>
document.getElementById("integralForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const func = document.getElementById("function").value;
  const a = document.getElementById("a").value;
  const b = document.getElementById("b").value;

  const res = await fetch("/integral", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ function: func, a, b })
  });

  const data = await res.json();
  const ctx = document.getElementById("integralChart");

  new Chart(ctx, {
    type: "line",
    data: {
      labels: data.x,
      datasets: [{
        label: `f(x) = ${func}`,
        data: data.y,
        borderColor: "#42a5f5",
        fill: true,
        backgroundColor: "rgba(66,165,245,0.2)"
      }]
    }
  });

  document.getElementById("areaResult").innerText = 
    `Luas area â‰ˆ ${data.area.toFixed(4)}`;
});
</script>
{% endblock %}
